CXX = g++
CU = nvcc
#CXX = g++-4.9
cflags = -Ofast -Wall -Wextra -Wconversion -fopenmp 
flags += -D_GPU -std=c++11
cuflags = -arch=sm_20 -O3
#libs = -L /usr/local/Cellar/openblas/0.2.13/lib -lopenblas
#inc = -I /usr/local/Cellar/openblas/0.2.13/include 
#libs = -lblas
#libs = -L /opt/OpenBLAS/lib -lopenblas
#inc = -I/opt/OpenBLAS/include
libs = -L/cm/shared/apps/openblas/dynamic/current/lib -lopenblas
libs += -lcudart -lcublas -L=/cm/shared/apps/cuda65/toolkit/6.5.14/lib64 
inc = -I/cm/shared/apps/openblas/dynamic/current/include

zefr:
	$(CXX) -c src/zefr.cpp src/input.cpp src/geometry.cpp src/faces.cpp src/elements.cpp src/funcs.cpp src/multigrid.cpp src/quads.cpp src/points.cpp src/polynomials.cpp src/solver.cpp src/shape.cpp -I include $(inc) $(flags)  $(cflags)
	$(CU) -c src/solver_kernels.cu -I include $(inc) $(flags) $(cuflags) -Xcompiler -fopenmp
	$(CXX) *.o $(libs) $(cflags) -o bin/zefr
clean:
	rm bin/zefr *.o
